apiVersion: apps/v1
kind: Deployment
metadata:
  name: vote
  namespace: voting
  labels:
    app: vote
spec:
  replicas: 2
  selector:
    matchLabels:
      app: vote
  template:
    metadata:
      labels:
        app: vote
    spec:
containers:
  - name: vote
    image: devivaraprasadjami/vote:latest    #replace with your actual image
    imagePullPolicy: IfNotPresent
    ports:
      - containerPort: 80
    env:
      - name: KAFKA_BROKERS
        valueFrom:
          configMapKeyRef:
            name: voting-config
            key: KAFKA_BOOTSTRAP_SERVERS
      - name: KAFKA_TOPIC
        valueFrom:
          configMapKeyRef:
            name: voting-config
            key: KAFKA_TOPIC
    readinessProbe:
      httpGet:
        path: /healthz
        port: 80
      initialDelaySeconds: 5
      periodSeconds: 10
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "250m"
        memory: "256Mi"
